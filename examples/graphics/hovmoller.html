

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Hovmoller diagram of monthly surface temperature &mdash; Iris 0.89 documentation</title>
    
    <link rel="stylesheet" href="../../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '0.89',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="copyright" title="Copyright" href="../../copyright.html" />
    <link rel="top" title="Iris 0.89 documentation" href="../../index.html" />
    <link rel="up" title="Visualisation examples" href="index.html" />
    <link rel="next" title="Seasonal ensemble model plots" href="lagged_ensemble.html" />
    <link rel="prev" title="Quickplot of a 2d cube on a map" href="global_map.html" />
 
<META HTTP-EQUIV="CACHE-CONTROL" CONTENT="NO-CACHE">

  </head>
  <body>
<div style="background-color: white; text-align: left; padding: 10px 10px 15px 15px">
<!-- Enable this to insert a logo...
<a href="../../index.html"><img src="../../_static/logo.png" style="float:right; clear:left; margin-right: 40px; " border="0" alt="Logo"/></a>
-->

<p style="margin-left: 15px; height:20px; font-weight:bolder; font-size:300%; letter-spacing:0.1ex;">
Iris 0.89
</p>

</div>

    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="lagged_ensemble.html" title="Seasonal ensemble model plots"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="global_map.html" title="Quickplot of a 2d cube on a map"
             accesskey="P">previous</a> |</li>
        <li><a href="../../index.html">home</a>|&nbsp;</li>
        <!-- <li><a href="../../search.html">search</a>|&nbsp;</li> -->
        <li><a href="../index.html">examples</a>|&nbsp;</li>
        <li><a href="../../gallery.html">gallery</a>|&nbsp;</li>
        <li><a href="../../contents.html">contents</a>|&nbsp;</li>

          <li><a href="../index.html" >Iris examples</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">Visualisation examples</a> &raquo;</li> 
      </ul>
    </div>

      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="global_map.html"
                        title="previous chapter">Quickplot of a 2d cube on a map</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="lagged_ensemble.html"
                        title="next chapter">Seasonal ensemble model plots</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../../_sources/examples/graphics/hovmoller.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="hovmoller-diagram-of-monthly-surface-temperature">
<span id="graphics-hovmoller"></span><h1>Hovmoller diagram of monthly surface temperature<a class="headerlink" href="#hovmoller-diagram-of-monthly-surface-temperature" title="Permalink to this headline">Â¶</a></h1>
<p>This example demonstrates the creation of a Hovmoller diagram with fine control over plot ticks and labels.
The data file being loaded is daily SST from the Met Office OSTIA project. As the plot is designed to show
annual variability, monthly data would be sufficient, therefore a constraint is used to filter all data which
does not fall on the first day of the month. A more sophisticated filtering scheme could be applied in practice,
perhaps taking the monthly mean as the data to plot.</p>
<p id="hovmoller">[<a class="reference external" href="../../plot_directive/../example_code/graphics/hovmoller.py">source code</a>]</p>
<blockquote>
<div><div class="figure">
<img alt="../../_images/hovmoller.png" src="../../_images/hovmoller.png" />
</div>
</div></blockquote>
<div class="highlight-python"><div class="highlight"><pre><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Hovmoller diagram of monthly surface temperature</span>
<span class="sd">================================================</span>

<span class="sd">This example demonstrates the creation of a Hovmoller diagram with fine control over plot ticks and labels.</span>
<span class="sd">The data file being loaded is daily SST from the Met Office OSTIA project. As the plot is designed to show</span>
<span class="sd">annual variability, monthly data would be sufficient, therefore a constraint is used to filter all data which</span>
<span class="sd">does not fall on the first day of the month. A more sophisticated filtering scheme could be applied in practice,</span>
<span class="sd">perhaps taking the monthly mean as the data to plot.</span>


<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib.dates</span> <span class="kn">as</span> <span class="nn">mdates</span>

<span class="kn">import</span> <span class="nn">iris</span>
<span class="kn">import</span> <span class="nn">iris.quickplot</span> <span class="kn">as</span> <span class="nn">qplt</span>
<span class="kn">import</span> <span class="nn">iris.unit</span>


<span class="k">def</span> <span class="nf">first_day_of_month</span><span class="p">(</span><span class="n">cube</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns true if the given cube&#39;s time bound is the first day of a month</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">time</span> <span class="o">=</span> <span class="n">cube</span><span class="o">.</span><span class="n">coord</span><span class="p">(</span><span class="s">&#39;time&#39;</span><span class="p">)</span>

    <span class="c"># get a datetime object for the time coordinate&#39;s lower bound</span>
    <span class="n">dt</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">num2date</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>

    <span class="c"># return true if the day of month is 1</span>
    <span class="k">return</span> <span class="n">dt</span><span class="o">.</span><span class="n">day</span> <span class="o">==</span> <span class="mi">1</span>


<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">fname</span> <span class="o">=</span> <span class="n">iris</span><span class="o">.</span><span class="n">sample_data_path</span><span class="p">(</span><span class="s">&#39;PP&#39;</span><span class="p">,</span> <span class="s">&#39;ostia&#39;</span><span class="p">,</span> <span class="s">&#39;ostia_sst_200604_201009_N216.pp&#39;</span><span class="p">)</span>

    <span class="c"># load a single cube of surface temperature between +/- 5 latitude, where each constituent field was the first day</span>
    <span class="c"># of the month</span>
    <span class="n">cube</span> <span class="o">=</span> <span class="n">iris</span><span class="o">.</span><span class="n">load_strict</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="n">iris</span><span class="o">.</span><span class="n">Constraint</span><span class="p">(</span><span class="s">&#39;surface_temperature&#39;</span><span class="p">,</span> <span class="n">latitude</span><span class="o">=</span><span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="o">-</span><span class="mi">5</span> <span class="o">&lt;</span> <span class="n">v</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">)</span> <span class="o">&amp;</span>
                                     <span class="n">iris</span><span class="o">.</span><span class="n">Constraint</span><span class="p">(</span><span class="n">cube_func</span><span class="o">=</span><span class="n">first_day_of_month</span><span class="p">)</span>
                            <span class="p">)</span>

    <span class="c"># Take the mean over latitude</span>
    <span class="n">cube</span> <span class="o">=</span> <span class="n">cube</span><span class="o">.</span><span class="n">collapsed</span><span class="p">(</span><span class="s">&#39;latitude&#39;</span><span class="p">,</span> <span class="n">iris</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">MEAN</span><span class="p">)</span>

    <span class="c"># Now that we have our data in a nice way, lets create the plot</span>
    <span class="c"># contour with 20 levels</span>
    <span class="n">qplt</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">cube</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>

    <span class="c"># Put a custom label on the y axis</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;Time / years&#39;</span><span class="p">)</span>

    <span class="c"># Stop matplotlib providing clever axes range padding</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s">&#39;tight&#39;</span><span class="p">)</span>

    <span class="c"># As we are plotting annual variability, put years as the y ticks</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">mdates</span><span class="o">.</span><span class="n">YearLocator</span><span class="p">())</span>

    <span class="c"># And format the ticks to just show the year</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">mdates</span><span class="o">.</span><span class="n">DateFormatter</span><span class="p">(</span><span class="s">&#39;%Y&#39;</span><span class="p">))</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="lagged_ensemble.html" title="Seasonal ensemble model plots"
             >next</a> |</li>
        <li class="right" >
          <a href="global_map.html" title="Quickplot of a 2d cube on a map"
             >previous</a> |</li>
        <li><a href="../../index.html">home</a>|&nbsp;</li>
        <!-- <li><a href="../../search.html">search</a>|&nbsp;</li> -->
        <li><a href="../index.html">examples</a>|&nbsp;</li>
        <li><a href="../../gallery.html">gallery</a>|&nbsp;</li>
        <li><a href="../../contents.html">contents</a>|&nbsp;</li>

          <li><a href="../index.html" >Iris examples</a> &raquo;</li>
          <li><a href="index.html" >Visualisation examples</a> &raquo;</li> 
      </ul>
    </div>

    <div class="footer">
    <p style="text-align: left; float: left; margin: 0px; padding: 0 0 0 5px;">Documentation licensed under the <a href="http://reference.data.gov.uk/id/open-government-licence" rel="license">Open Government Licence</a></p>
        &copy; <a href="../../copyright.html">British Crown Copyright</a> 2010 - 2012, Met Office
    </div>


  </body>
</html>